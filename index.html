<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#0f172a">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>旅程預算 | Polished</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons (Stable) -->
    <script src="https://cdn.jsdelivr.net/npm/lucide@latest/dist/umd/lucide.min.js"></script>
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { 
                        sans: ['Plus Jakarta Sans', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    boxShadow: {
                        'glow-teal': '0 0 20px rgba(20, 184, 166, 0.3)',
                        'glow-indigo': '0 0 20px rgba(99, 102, 241, 0.3)',
                        'glass': '0 8px 32px 0 rgba(0, 0, 0, 0.3)',
                    },
                    animation: {
                        'slide-up': 'slideUp 0.3s cubic-bezier(0.16, 1, 0.3, 1) forwards',
                        'fade-in': 'fadeIn 0.4s ease-out forwards',
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    },
                    keyframes: {
                        slideUp: {
                            'from': { transform: 'translateY(100%)' },
                            'to': { transform: 'translateY(0)' },
                        },
                        fadeIn: {
                            'from': { opacity: '0', transform: 'translateY(10px)' },
                            'to': { opacity: '1', transform: 'translateY(0)' },
                        }
                    }
                }
            }
        }
    </script>
    
    <style>
        body {
            background-color: #0f172a;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }

        /* Enhanced Background */
        .aurora-bg {
            position: fixed;
            inset: 0;
            background: 
                radial-gradient(circle at 0% 0%, rgba(20, 184, 166, 0.15) 0%, transparent 50%), 
                radial-gradient(circle at 100% 100%, rgba(99, 102, 241, 0.15) 0%, transparent 50%);
            z-index: -10;
            pointer-events: none;
        }
        
        .blob {
            position: fixed;
            border-radius: 50%;
            filter: blur(80px);
            z-index: -9;
            opacity: 0.5;
            animation: float 10s infinite ease-in-out;
        }
        @keyframes float {
            0%, 100% { transform: translate(0, 0); }
            50% { transform: translate(-20px, 20px); }
        }

        /* Polished Glass Components */
        .glass-panel {
            background: rgba(30, 41, 59, 0.7); 
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .glass-card {
            background: linear-gradient(180deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.03) 100%);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transition: transform 0.1s, background 0.2s;
        }
        .glass-card:active {
            transform: scale(0.98);
            background: rgba(255,255,255,0.1);
        }

        /* Bottom Sheet */
        .bottom-sheet {
            position: fixed;
            bottom: 0; left: 0; right: 0;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(24px);
            -webkit-backdrop-filter: blur(24px);
            border-top-left-radius: 24px;
            border-top-right-radius: 24px;
            border-top: 1px solid rgba(255,255,255,0.15);
            z-index: 50;
            transform: translateY(110%);
            transition: transform 0.35s cubic-bezier(0.32, 0.72, 0, 1);
            box-shadow: 0 -20px 50px rgba(0,0,0,0.5);
            padding-bottom: env(safe-area-inset-bottom);
        }
        .bottom-sheet.active { transform: translateY(0); }

        .sheet-overlay {
            position: fixed; inset: 0;
            background: rgba(0,0,0,0.7);
            backdrop-filter: blur(4px);
            z-index: 40;
            opacity: 0; pointer-events: none;
            transition: opacity 0.3s;
        }
        .sheet-overlay.active { opacity: 1; pointer-events: auto; }

        /* Form Elements */
        .input-group {
            position: relative;
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 16px;
            transition: all 0.2s;
        }
        .input-group:focus-within {
            background: rgba(255,255,255,0.08);
            border-color: rgba(99, 102, 241, 0.5);
            box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.2);
        }
        .input-field {
            width: 100%;
            background: transparent;
            border: none;
            color: white;
            padding: 16px;
            outline: none;
            font-size: 16px;
        }

        /* Utilities */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .text-glow { text-shadow: 0 0 10px rgba(255,255,255,0.3); }
    </style>
</head>
<body class="text-slate-100 h-[100dvh] overflow-hidden flex flex-col font-sans" onload="window.ui.init()">

    <!-- Decorative Background -->
    <div class="aurora-bg"></div>
    <div class="blob bg-indigo-600 w-80 h-80 top-[-10%] left-[-10%]"></div>
    <div class="blob bg-teal-600 w-64 h-64 bottom-[-10%] right-[-10%] animation-delay-2000"></div>

    <!-- Notifications -->
    <div id="toast" class="fixed top-6 left-4 right-4 z-[100] translate-y-[-150%] transition-transform duration-300 flex justify-center">
        <div class="glass-panel px-6 py-3 rounded-full shadow-lg flex items-center gap-3">
            <div id="toast-icon" class="text-white"></div>
            <span id="toast-msg" class="text-sm font-medium text-white"></span>
        </div>
    </div>

    <!-- Header -->
    <header class="pt-safe-top mt-2 px-6 pb-2 flex justify-between items-center z-10 shrink-0">
        <div>
            <div class="text-[10px] font-bold tracking-[0.2em] text-teal-400 uppercase mb-1">Travel Budget</div>
            <h1 class="text-2xl font-bold tracking-tight text-white flex items-center gap-2">
                旅程預算 <span class="text-xs bg-white/10 px-2 py-0.5 rounded text-white/60 font-normal">PRO</span>
            </h1>
        </div>
        <div class="glass-panel px-3 py-1.5 rounded-full flex items-center gap-2 border border-white/10 shadow-lg">
            <div class="w-1.5 h-1.5 rounded-full bg-green-400 animate-pulse-slow"></div>
            <span class="text-xs font-mono text-white/80">R 1.13</span>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-1 overflow-y-auto no-scrollbar px-4 pt-2 pb-32 space-y-6" id="main-scroll">
        
        <!-- Dashboard Cards -->
        <div class="grid grid-cols-2 gap-3">
            <!-- CNY Card -->
            <button onclick="ui.toggleModal(true)" class="glass-card p-5 rounded-[20px] text-left relative overflow-hidden group">
                <div class="absolute right-[-10px] top-[-10px] w-20 h-20 bg-teal-500/10 rounded-full blur-xl"></div>
                <div class="flex items-center gap-2 mb-3">
                    <div class="p-2 bg-teal-500/10 rounded-full text-teal-400">
                        <i data-lucide="yen" class="w-4 h-4"></i>
                    </div>
                    <span class="text-xs font-semibold text-teal-200/60 uppercase tracking-wide">CNY 總計</span>
                </div>
                <div class="text-2xl font-bold text-white font-mono tracking-tight" id="total-cny">¥0.00</div>
            </button>
            
            <!-- HKD Card -->
            <button onclick="ui.toggleModal(true)" class="glass-card p-5 rounded-[20px] text-left relative overflow-hidden group">
                <div class="absolute right-[-10px] top-[-10px] w-20 h-20 bg-indigo-500/10 rounded-full blur-xl"></div>
                <div class="flex items-center gap-2 mb-3">
                    <div class="p-2 bg-indigo-500/10 rounded-full text-indigo-400">
                        <i data-lucide="dollar-sign" class="w-4 h-4"></i>
                    </div>
                    <span class="text-xs font-semibold text-indigo-200/60 uppercase tracking-wide">HKD 總計</span>
                </div>
                <div class="text-2xl font-bold text-white font-mono tracking-tight" id="total-hkd">$0.00</div>
            </button>
        </div>

        <!-- Regional Pills -->
        <div class="flex gap-3 overflow-x-auto no-scrollbar py-1">
            <div class="glass-panel px-4 py-3 rounded-[16px] flex items-center gap-3 border-l-4 border-l-teal-500 min-w-[140px]">
                <div>
                    <div class="text-[10px] text-white/50 uppercase font-bold">Shenzhen</div>
                    <div class="font-mono font-bold text-white" id="sz-total">¥0</div>
                </div>
            </div>
            <div class="glass-panel px-4 py-3 rounded-[16px] flex items-center gap-3 border-l-4 border-l-indigo-500 min-w-[140px]">
                <div>
                    <div class="text-[10px] text-white/50 uppercase font-bold">Hong Kong</div>
                    <div class="font-mono font-bold text-white" id="hk-total">$0</div>
                </div>
            </div>
        </div>

        <!-- List Header & Toggle -->
        <div class="flex justify-between items-end px-1 mt-2">
            <h2 class="text-lg font-bold text-white/90">消費明細</h2>
            <div class="glass-panel p-1 rounded-lg flex gap-1">
                <button onclick="ui.setViewMode('list')" id="btn-list" class="p-2 rounded-md bg-white/10 text-white shadow-sm transition-all"><i data-lucide="layout-list" class="w-4 h-4"></i></button>
                <button onclick="ui.setViewMode('table')" id="btn-table" class="p-2 rounded-md text-white/40 hover:text-white transition-all"><i data-lucide="table-2" class="w-4 h-4"></i></button>
            </div>
        </div>

        <!-- Dynamic Content -->
        <div id="content-area" class="pb-safe min-h-[200px]"></div>

    </main>

    <!-- Floating Action Button -->
    <button onclick="ui.openSheet()" class="fixed bottom-8 right-6 w-16 h-16 bg-gradient-to-br from-indigo-500 to-teal-500 rounded-full shadow-glow-indigo flex items-center justify-center text-white z-40 active:scale-90 transition-transform duration-200 border border-white/20">
        <i data-lucide="plus" class="w-7 h-7"></i>
    </button>

    <!-- Bottom Sheet Form -->
    <div class="sheet-overlay" id="overlay" onclick="ui.closeSheet()"></div>
    <div class="bottom-sheet" id="sheet">
        <div class="w-full flex justify-center pt-4 pb-2" onclick="ui.closeSheet()">
            <div class="w-12 h-1.5 bg-white/10 rounded-full"></div>
        </div>

        <div class="p-6 space-y-6">
            <div class="text-center">
                <h3 class="text-lg font-bold text-white">新增消費</h3>
                <p class="text-xs text-white/40">輸入金額將自動換算匯率</p>
            </div>
            
            <form id="add-form" class="space-y-4">
                <!-- Region Selector -->
                <div class="grid grid-cols-2 gap-3 p-1 bg-white/5 rounded-2xl border border-white/5">
                    <button type="button" id="tab-sz" onclick="ui.setRegion('SZ')" class="py-3 rounded-xl text-sm font-bold bg-teal-600 text-white shadow-lg transition-all flex items-center justify-center gap-2">
                        <span class="w-1.5 h-1.5 rounded-full bg-white"></span> 深圳 (RMB)
                    </button>
                    <button type="button" id="tab-hk" onclick="ui.setRegion('HK')" class="py-3 rounded-xl text-sm font-bold text-white/40 hover:text-white transition-all flex items-center justify-center gap-2">
                         香港 (HKD)
                    </button>
                </div>

                <!-- Inputs -->
                <div class="space-y-3">
                    <div class="input-group">
                        <input type="text" id="in-item" placeholder="消費項目 (如: 晚餐)" class="input-field" required autocomplete="off">
                    </div>
                    
                    <div class="flex gap-3">
                        <div class="input-group flex-[1.5] flex items-center pl-4">
                            <span id="in-symbol" class="text-white/40 font-mono font-bold text-lg">¥</span>
                            <input type="number" id="in-amt" inputmode="decimal" placeholder="0.00" class="input-field font-mono text-lg font-bold" required>
                        </div>
                        <div class="input-group flex-1">
                            <input type="text" id="in-loc" placeholder="地點" class="input-field text-sm">
                        </div>
                    </div>
                </div>

                <button type="submit" class="w-full py-4 bg-white text-slate-900 font-bold text-lg rounded-2xl active:scale-[0.98] transition-transform shadow-lg mt-4 flex items-center justify-center gap-2">
                    <i data-lucide="check-circle" class="w-5 h-5"></i> 確認新增
                </button>
            </form>
        </div>
    </div>

    <!-- Modal (Full Screen History) -->
    <div id="modal" class="fixed inset-0 z-50 bg-[#0f172a]/95 backdrop-blur-xl hidden flex flex-col animate-fade-in">
        <div class="pt-safe-top mt-4 px-6 pb-4 flex justify-between items-center border-b border-white/10">
            <h2 class="text-xl font-bold text-white">所有記錄</h2>
            <button onclick="ui.toggleModal(false)" class="p-2 bg-white/10 rounded-full text-white/70 hover:text-white"><i data-lucide="x" class="w-5 h-5"></i></button>
        </div>
        <div id="modal-content" class="flex-1 overflow-y-auto p-4 no-scrollbar"></div>
    </div>

    <!-- Logic -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getFirestore, collection, addDoc, deleteDoc, onSnapshot, doc, query } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";

        const CONFIG = {
            apiKey: "AIzaSyBAADMQZ5_h_bXX2jDpR27huv4c5Eb3hfc",
            authDomain: "chinarc-17230.firebaseapp.com",
            projectId: "chinarc-17230",
            storageBucket: "chinarc-17230.firebasestorage.app",
            messagingSenderId: "1038021165523",
            appId: "1:1038021165523:web:6c75a98519dde3cafe2f26",
            measurementId: "G-0F8R1H2QFL"
        };
        const RATE = 1.13;
        const APP_ID = 'travel-budget-v1';

        let db, auth, user;
        let items = [];

        // Global UI State & Methods
        window.state = {
            view: 'list',
            region: 'SZ'
        };

        window.ui = {
            init: () => {
                lucide.createIcons();
            },
            openSheet: () => {
                document.getElementById('sheet').classList.add('active');
                document.getElementById('overlay').classList.add('active');
                setTimeout(() => document.getElementById('in-item').focus(), 150);
            },
            closeSheet: () => {
                document.getElementById('sheet').classList.remove('active');
                document.getElementById('overlay').classList.remove('active');
                document.activeElement.blur();
            },
            toggleModal: (show) => {
                const el = document.getElementById('modal');
                if(show) {
                    el.classList.remove('hidden');
                    renderTable(document.getElementById('modal-content'));
                } else {
                    el.classList.add('hidden');
                }
            },
            setRegion: (r) => {
                window.state.region = r;
                const szBtn = document.getElementById('tab-sz');
                const hkBtn = document.getElementById('tab-hk');
                const sym = document.getElementById('in-symbol');
                
                if (r === 'SZ') {
                    szBtn.className = "py-3 rounded-xl text-sm font-bold bg-teal-600 text-white shadow-lg transition-all flex items-center justify-center gap-2";
                    hkBtn.className = "py-3 rounded-xl text-sm font-bold text-white/40 hover:text-white transition-all flex items-center justify-center gap-2";
                    sym.innerText = '¥';
                } else {
                    szBtn.className = "py-3 rounded-xl text-sm font-bold text-white/40 hover:text-white transition-all flex items-center justify-center gap-2";
                    hkBtn.className = "py-3 rounded-xl text-sm font-bold bg-indigo-600 text-white shadow-lg transition-all flex items-center justify-center gap-2";
                    sym.innerText = '$';
                }
            },
            setViewMode: (mode) => {
                window.state.view = mode;
                document.getElementById('btn-list').className = mode === 'list' ? "p-2 rounded-md bg-white/10 text-white shadow-sm" : "p-2 rounded-md text-white/40";
                document.getElementById('btn-table').className = mode === 'table' ? "p-2 rounded-md bg-white/10 text-white shadow-sm" : "p-2 rounded-md text-white/40";
                renderMain();
            },
            toast: (msg, type = 'info') => {
                const el = document.getElementById('toast');
                const icon = document.getElementById('toast-icon');
                document.getElementById('toast-msg').innerText = msg;
                icon.innerHTML = type === 'error' ? '<i data-lucide="alert-circle" class="w-5 h-5"></i>' : '<i data-lucide="check" class="w-5 h-5"></i>';
                el.style.transform = "translateY(0)";
                lucide.createIcons();
                setTimeout(() => el.style.transform = "translateY(-150%)", 3000);
            },
            fmt: (n) => new Intl.NumberFormat('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 2 }).format(n||0)
        };

        // --- Renderers ---
        const renderList = (container) => {
            if (items.length === 0) {
                container.innerHTML = `<div class="flex flex-col items-center justify-center py-20 opacity-30"><i data-lucide="ghost" class="w-12 h-12 mb-2"></i><span class="text-sm">這裡空空如也</span></div>`;
                lucide.createIcons();
                return;
            }

            container.innerHTML = items.map(item => {
                const isSZ = item.region === 'SZ';
                const mainAmt = isSZ ? item.cny : item.hkd;
                const subAmt = isSZ ? item.hkd : item.cny;
                const mainSym = isSZ ? '¥' : '$';
                const subSym = isSZ ? 'HKD ' : 'RMB ';
                const colorClass = isSZ ? 'border-l-teal-500' : 'border-l-indigo-500';

                return `
                <div class="glass-card p-4 mb-3 rounded-xl border-l-4 ${colorClass} flex justify-between items-center animate-fade-in group relative overflow-hidden">
                    <div class="flex-1 pr-4 z-10">
                        <div class="font-bold text-white text-lg leading-tight mb-1">${item.item}</div>
                        ${item.location ? `<div class="flex items-center gap-1 text-xs text-white/40 font-medium"><i data-lucide="map-pin" class="w-3 h-3"></i> ${item.location}</div>` : ''}
                    </div>
                    <div class="text-right z-10">
                        <div class="font-mono font-bold text-xl text-white tracking-tight">
                            <span class="text-sm opacity-50 mr-1">${mainSym}</span>${ui.fmt(mainAmt)}
                        </div>
                        <div class="font-mono text-xs text-white/40 mt-0.5">
                            ${subSym}${ui.fmt(subAmt)}
                        </div>
                    </div>
                    <button data-id="${item.id}" class="del-btn absolute right-0 top-0 bottom-0 w-16 bg-red-500/10 text-red-400 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center z-20 active:bg-red-500/20">
                        <i data-lucide="trash-2" class="w-5 h-5"></i>
                    </button>
                </div>`;
            }).join('');
            
            attachEvents();
            lucide.createIcons();
        };

        const renderTable = (container) => {
            container.innerHTML = `
            <div class="glass-panel rounded-xl overflow-hidden">
                <table class="w-full text-left text-xs border-collapse table-fixed">
                    <thead class="bg-white/5 text-white/40 uppercase font-bold tracking-wider border-b border-white/5">
                        <tr>
                            <th class="p-4 w-5/12">Item</th>
                            <th class="p-4 text-right w-3/12">CNY</th>
                            <th class="p-4 text-right w-3/12">HKD</th>
                            <th class="p-4 w-1/12"></th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-white/5 font-mono">
                        ${items.map(i => `
                        <tr class="hover:bg-white/5 transition-colors">
                            <td class="p-4 font-sans font-medium text-white truncate">
                                ${i.item}
                                ${i.location ? `<div class="text-[10px] text-white/30 font-sans mt-0.5">${i.location}</div>` : ''}
                            </td>
                            <td class="p-4 text-right ${i.region==='SZ'?'text-teal-400 font-bold':'text-white/50'}">${ui.fmt(i.cny)}</td>
                            <td class="p-4 text-right ${i.region==='HK'?'text-indigo-400 font-bold':'text-white/50'}">${ui.fmt(i.hkd)}</td>
                            <td class="p-4 text-center">
                                <button data-id="${i.id}" class="del-btn text-white/20 hover:text-red-400 p-2"><i data-lucide="x" class="w-4 h-4"></i></button>
                            </td>
                        </tr>`).join('')}
                    </tbody>
                </table>
            </div>`;
            attachEvents();
            lucide.createIcons();
        };

        const renderMain = () => {
            const el = document.getElementById('content-area');
            if(window.state.view === 'list') renderList(el);
            else renderTable(el);
        };

        const attachEvents = () => {
            document.querySelectorAll('.del-btn').forEach(b => {
                b.addEventListener('click', async (e) => {
                    e.stopPropagation();
                    if(confirm("刪除此項目？")) {
                        try {
                            await deleteDoc(doc(db, 'artifacts', APP_ID, 'users', user.uid, 'budget_items', b.dataset.id));
                            ui.toast("已刪除");
                        } catch(err) { ui.toast("刪除失敗", "error"); }
                    }
                });
            });
        };

        const updateStats = () => {
            const sum = (fn) => items.reduce((a, b) => a + (fn(b)||0), 0);
            const totalCNY = sum(i => i.cny);
            const totalHKD = sum(i => i.hkd);
            const sz = items.filter(i=>i.region==='SZ').reduce((a,b)=>a+(b.cny||0),0);
            const hk = items.filter(i=>i.region==='HK').reduce((a,b)=>a+(b.hkd||0),0);

            document.getElementById('total-cny').innerText = `¥${ui.fmt(totalCNY)}`;
            document.getElementById('total-hkd').innerText = `$${ui.fmt(totalHKD)}`;
            document.getElementById('sz-total').innerText = `¥${ui.fmt(sz)}`;
            document.getElementById('hk-total').innerText = `$${ui.fmt(hk)}`;
        };

        // --- Core ---
        (async () => {
            try {
                const app = initializeApp(CONFIG);
                db = getFirestore(app);
                auth = getAuth(app);

                onAuthStateChanged(auth, (u) => {
                    user = u;
                    if(u) {
                        const q = query(collection(db, 'artifacts', APP_ID, 'users', u.uid, 'budget_items'));
                        onSnapshot(q, (snap) => {
                            items = snap.docs.map(d => ({id:d.id, ...d.data()})).sort((a,b)=>(b.createdAt||0)-(a.createdAt||0));
                            updateStats();
                            renderMain();
                            if(!document.getElementById('modal').classList.contains('hidden')) renderTable(document.getElementById('modal-content'));
                        });
                    } else {
                        signInAnonymously(auth);
                    }
                });

                // Form
                document.getElementById('add-form').addEventListener('submit', async (e) => {
                    e.preventDefault();
                    if(!user) return ui.toast("尚未連線", "error");

                    const name = document.getElementById('in-item').value;
                    const val = parseFloat(document.getElementById('in-amt').value);
                    const loc = document.getElementById('in-loc').value;
                    if(!name || isNaN(val)) return;

                    const isSZ = window.state.region === 'SZ';
                    const cny = isSZ ? val : val/RATE;
                    const hkd = isSZ ? val*RATE : val;

                    try {
                        await addDoc(collection(db, 'artifacts', APP_ID, 'users', user.uid, 'budget_items'), {
                            item: name, location: loc, cny, hkd, region: window.state.region, createdAt: Date.now()
                        });
                        document.getElementById('in-item').value = '';
                        document.getElementById('in-amt').value = '';
                        document.getElementById('in-loc').value = '';
                        ui.closeSheet();
                        ui.toast("新增成功");
                    } catch(err) { ui.toast("新增失敗", "error"); }
                });

            } catch(e) { console.error(e); }
        })();
    </script>
</body>
</html>

